<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forecasting App</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h1 { text-align: center; }
        .container { max-width: 600px; margin: 0 auto; }
        label, select, input { width: 100%; margin: 10px 0; }
        button { width: 100%; padding: 10px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #45a049; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    </style>
</head>
<body>

    <div class="container">
        <h1>Forecasting App</h1>

        <!-- File Upload Form -->
        <form id="upload-form" enctype="multipart/form-data">
            <label for="file">Upload CSV File</label>
            <input type="file" id="file" name="file" required>

            <label for="date-column">Select Date Column</label>
            <input type="text" id="date-column" name="date_col" required>

            <label for="value-column">Select Value Column</label>
            <input type="text" id="value-column" name="value_col" required>

            <label for="forecast-frequency">Select Frequency</label>
            <select id="forecast-frequency" name="frequency">
                <option value="weekly">Weekly</option>
                <option value="monthly">Monthly</option>
                <option value="quarterly">Quarterly</option>
                <option value="yearly">Yearly</option>
            </select>

            <label for="forecast-period">Select Period</label>
            <input type="number" id="forecast-period" name="period" placeholder="Enter forecast period" required>

            <label for="forecast-method">Select Forecast Method</label>
            <select id="forecast-method" name="method">
                <option value="sma">Simple Moving Average</option>
                <option value="wma">Weighted Moving Average</option>
            </select>

            <button type="button" id="generate-forecast">Generate Forecast</button>
        </form>

        <!-- Forecast Results Table -->
        <div id="forecast-results">
            <h3>Forecast Results</h3>
            <table id="forecast-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Forecast</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Forecast results will be populated here -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        document.getElementById('generate-forecast').addEventListener('click', function() {
            const formData = new FormData();
            formData.append('file', document.getElementById('file').files[0]);
            formData.append('date_col', document.getElementById('date-column').value);
            formData.append('value_col', document.getElementById('value-column').value);
            formData.append('frequency', document.getElementById('forecast-frequency').value);
            formData.append('period', document.getElementById('forecast-period').value);
            formData.append('method', document.getElementById('forecast-method').value);

            fetch('/forecast', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.forecast) {
                    const tbody = document.getElementById('forecast-table').getElementsByTagName('tbody')[0];
                    tbody.innerHTML = ''; // Clear any previous results
                    data.forecast.forEach(forecast => {
                        const row = tbody.insertRow();
                        const dateCell = row.insertCell(0);
                        const forecastCell = row.insertCell(1);
                        dateCell.textContent = forecast.Date;
                        forecastCell.textContent = forecast.Forecast;
                    });
                } else {
                    alert('Error: ' + data.error);
                }
            })
            .catch(error => console.error('Error:', error));
        });
    </script>

</body>
</html>
